<!DOCTYPE html>
<html>
    <head>
        <title>Apache Tomcat : Connectors</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Apache Tomcat</a></span>
                            </li>
                                                    <li>
                                <span><a href="Apache-Tomcat-Home_61320756.html">Apache Tomcat Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="FAQ_103098750.html">FAQ</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Apache Tomcat : Connectors
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> ASF Infrabot</span>, last modified by <span class='editor'> Konstantin Kolinko</span> on ноя 24, 2019
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><em>Permalink</em> to this page: <a href="https://cwiki.apache.org/confluence/x/yiklBg" rel="nofollow">https://cwiki.apache.org/confluence/x/yiklBg</a></p><h2 id="Connectors-Preface">Preface</h2><p>Please see the <a href="UsefulLinks_103100724.html">Other Resources Link</a> for other pages describing how they were able to link Tomcat with a connector. With luck, someone documented their experience in an environment which is similar to yours.</p><p>Here is a link to the <a class="external-link" href="https://tomcat.apache.org/connectors-doc/" rel="nofollow">Apache Tomcat Connectors</a> (aka JK Connectors) project page. It contains more configuration and installation information.</p><p><strong>Please note, jk2 is no longer supported. Please use mod_jk instead.</strong></p><h2 id="Connectors-Questions">Questions</h2><ol><li><a href="#Connectors-Q1">What is JK (or AJP)?</a></li><li><a href="#Connectors-Q2">Which connector: mod_jk or mod_proxy?</a></li><li><a href="#Connectors-Q2.1">What about mod_jserv, mod_jk2, mod_webapp (aka warp)?</a></li><li><a href="#Connectors-Q3">Why should I integrate Apache HTTP Server with Apache Tomcat? (or not)</a></li><li><a href="#Connectors-Q4">At boot, is order of start up (Apache HTTP Server vs Apache Tomcat) important?</a></li><li><a href="#Connectors-Q5">Is there any way to control the content of automatically generated mod_jk.conf-auto?</a></li><li><a href="#Connectors-Q6">How do I bind to a specific IP address?</a></li><li><a href="#Connectors-Q7">Where can I download a binary distribution of my connector?</a></li><li><a href="#Connectors-Q8">I'm having strange UTF-8 issues with my request parameters.</a></li><li><a href="#Connectors-Q9">How do I configure apache tomcat connectors for a heavy load site?</a></li></ol><h2 id="Connectors-Answers">Answers</h2><h3 id="Connectors-Q1WhatisJK(orAJP)?"><span class="confluence-anchor-link" id="Connectors-Q1"></span>What is JK (or AJP)?</h3><p>AJP is a wire protocol. It an optimized version of the HTTP protocol to allow a standalone web server such as <a class="external-link" href="https://httpd.apache.org/" rel="nofollow">Apache</a> to talk to Tomcat. Historically, Apache has been much faster than Tomcat at serving static content. The idea is to let Apache serve the static content when possible, but proxy the request to Tomcat for Tomcat related content.</p><h3 id="Connectors-Q2Whichconnector:mod_jkormod_proxy?"><span class="confluence-anchor-link" id="Connectors-Q2"></span>Which connector: mod_jk or mod_proxy?</h3><ul><li>mod_jk is mature, stable and extremely flexible. It is under active development by members of the Tomcat community.</li><li>mod_proxy_ajp is distributed with Apache httpd 2.2 and later. Note that the communication protocol used is AJP.</li><li>mod_proxy_http is a cheap way to proxy without the hassles of configuring JK. If you don't need some of the features of mod_jk, this is a very simple alternative. Note that the communication protocol used is HTTP/1.1.</li><li>mod_proxy_http2 uses HTTP/2 as communication protocol. I has support for both secure (h2) and cleartext (h2c) variants of HTTP/2. Both are understood by Tomcat 8.5 and later.</li></ul><p>Here are some anecdotal comments from members of the Tomcat community:</p><p style="margin-left: 30.0px;">_ I have been using mod_jk for a very long time and I saw (at the time) only one reason to make the switch to mod_proxy_ajp: it is bundled with Apache and so you (likely) don't have to build the module yourself.</p><p style="margin-left: 30.0px;">That said, simple configurations are *way* more simple in mod_proxy_ajp than with mod_jk, although the (somewhat) recent addition of <code>JkWorkerProperty</code> and <code>JkMount</code> &quot;extensions&quot; do help quite a bit.</p><p style="margin-left: 30.0px;">mod_proxy_ajp can also be trivially swapped-out with mod_proxy_http just by changing the URLs in your <code>ProxyPass</code> and <code>ProxyPassReverse</code> directives to say http:// (or https://) instead of ajp://. This might help you if you need to switch protocols for debugging purposes or if you suddenly need switch to HTTPS to secure the traffic without any external configuration (e.g. stunnel or VPN). (See <a href="AJP-with-stunnel_103098444.html">AJP with stunnel</a>.)</p><p style="margin-left: 30.0px;">mod_proxy also supports <code>ProxyPassMatch</code> directive which lets you use regular expressions in your URL mappings, which mod_jk's <code>JkMount</code> does not (though you *can* use <code>&lt;LocationMatch&gt;</code> along with <code>SetHandler</code> in order to achieve the same result, it's a cleaner configuration with mod_proxy).</p><p style="margin-left: 30.0px;">That said, I have found that mod_jk supports more complicated configurations where I have struggled to get mod_proxy_ajp to do the same. Specifically, overlapping URL spaces that must be mapped to separate workers. Technically speaking, I suppose you could use lots of <code>ProxyPassMatch</code> directives and/or have a complex regular expression to direct the various URLs, but again you end up with a rather messy configuration that way. Messy configurations are a maintenance risk as well as at risk of becoming &quot;arcane knowledge&quot; that nobody actually understands and so they are afraid to modify it for any reason.</p><p style="margin-left: 30.0px;">Generally, mod_jk will get fixed faster than mod_proxy_ajp due to its independent release cycle: the httpd folks might have a fix for a problem but it doesn't get released for a while due to testing of other components, etc. At this point, mod_proxy_ajp has (IMHO) reached a point of stability that this is less of an issue than it used to be.</p><p style="margin-left: 30.0px;">At this stage, there is no reason for me to move any of my projects from mod_jk to mod_proxy_ajp but if I were starting from scratch, I might choose mod_proxy_ajp solely due to its binary availability and simple configuration. If the configuration became complicated to the extent that switching to mod_jk were a good option, then I'd move.</p><p style="margin-left: 30.0px;">As for performance, I have no data on that one way or another. I would suspect that mod_jk has a slight performance advantage because it has been especially designed for the purpose rather than mod_proxy_ajp which must support the mod_proxy API and might have a bit more plumbing code to accomplish that. I would be surprised if you could detect any performance difference between the two if you were to test them both faithfully and with compatible configurations. If anyone has relative performance data between mod_jk and mod_proxy_ajp, I'd be happy to read it._ <br/>(Source: <a class="external-link" href="https://tomcat.markmail.org/message/u5v4aiejluzy7tde" rel="nofollow">https://tomcat.markmail.org/message/u5v4aiejluzy7tde</a>)</p><h3 id="Connectors-Q2.1Whataboutmod_jserv,mod_jk2,mod_webapp(akawarp)?"><span class="confluence-anchor-link" id="Connectors-Q2.1"></span>What about mod_jserv, mod_jk2, mod_webapp (aka warp)?</h3><p><strong>All of these connectors have been abandoned long ago. Do not use any of them.</strong></p><p>mod_jk2 sounds like it could be an updated version of mod_jk, it is not: it was an aborted effort whose features have been re-incorporated into mod_jk.</p><p>For historical purposes, and emphasis:</p><ul><li>mod_jserv is unsupported and will not be supported in Tomcat 5 onward. mod_jserv was the original connector which supported the ajp protocol. <strong>Do not use mod_jserv.</strong></li><li>Stay away from mod_webapp, aka warp. It is deprecated and unsupported due to lack of developer interest and there are better options such as jk and mod_proxy. It WILL NOT run on windows. <strong>Do not use mod_webapp or warp.</strong></li><li>jk2 is a refactoring of mod_jk and uses the Apache Portable Runtime (apr). But due to lack of developer interest, it is unsupported. <strong>Do not use mod_jk2.</strong></li></ul><h3 id="Connectors-Q3WhyshouldIintegrateApacheHTTPServerwithApacheTomcat?(ornot)"><span class="confluence-anchor-link" id="Connectors-Q3"></span>Why should I integrate Apache HTTP Server with Apache Tomcat? (or not)</h3><p>There are many reasons to integrate Tomcat with Apache. And there are reasons why it should not be done too. Needless to say, everyone will disagree with the opinions here. With the performance of Tomcat 5 and 6, performance reasons become harder to justify. So here are the issues to discuss in integrating vs not.</p><ul><li>Clustering. By using Apache as a front end you can let Apache act as a front door to your content to multiple Tomcat instances. If one of your Tomcats fails, Apache ignores it and your Sysadmin can sleep through the night. This point could be ignored if you use a hardware loadbalancer and Tomcat's clustering capabilities.</li><li>Clustering/Security. You can also use Apache as a front door to different Tomcats for different URL namespaces (/app1/, /app2/, /app3/, or virtual hosts). The Tomcats can then be each in a protected area and from a security point of view, you only need to worry about the Apache server. Essentially, Apache becomes a smart proxy server.</li><li>Security. This topic can sway one either way. Java has the security manager while Apache has a larger mindshare and more tricks with respect to security. I won't go into this in more detail, but let Google be your friend. Depending on your scenario, one might be better than the other. But also keep in mind, if you run Apache with Tomcat - you have two systems to defend, not one.</li><li>Add-ons. Adding on CGI, perl, PHP is very natural to Apache. Its slower and more of a kludge for Tomcat. Apache also has hundreds of modules that can be plugged in at will. Tomcat can have this ability, but the code hasn't been written yet.</li><li>Decorators! With Apache in front of Tomcat, you can perform any number of decorators that Tomcat doesn't support or doesn't have the immediate code support. For example, mod_headers, mod_rewrite, and mod_alias could be written for Tomcat, but why reinvent the wheel when Apache has done it so well?</li><li>Speed. Apache is faster at serving static content than Tomcat. But unless you have a high traffic site, this point is useless. But in some scenarios, tomcat can be faster than Apache httpd. So benchmark YOUR site. <strong>Tomcat can perform at httpd speeds when using the proper connector (APR with sendFile enabled). Speed should not be considered a factor when choosing between Apache httpd and Tomcat</strong></li><li>Socket handling/system stability. Apache has better socket handling with respect to error conditions than Tomcat. The main reason is Tomcat must perform all its socket handling via the JVM which needs to be cross platform. The problem is socket optimization is a platform specific ordeal. Most of the time the java code is fine, but when you are also bombarded with dropped connections, invalid packets, invalid requests from invalid IP's, Apache does a better job at dropping these error conditions than JVM based program. (YMMV)</li></ul><h3 id="Connectors-Q4Atboot,isorderofstartup(ApacheHTTPServervsApacheTomcat)important?"><span class="confluence-anchor-link" id="Connectors-Q4"></span>At boot, is order of start up (Apache HTTP Server vs Apache Tomcat) important?</h3><p>No. This way either Apache HTTPd or Apache Tomcat can be restarted at any time independently of one another.</p><h3 id="Connectors-Q5Isthereanywaytocontrolthecontentofautomaticallygeneratedmod_jk.conf-auto?Ineedmyownspecificcommandsaddedtoit."><span class="confluence-anchor-link" id="Connectors-Q5"></span>Is there any way to control the content of automatically generated mod_jk.conf-auto? I need my own specific commands added to it.</h3><p>There really is no need to. Just copy the automatically generated mod_jk.conf-auto and edit it manually to your preference. None of production tomcat installations really use mod_jk.conf-auto as it is.</p><h3 id="Connectors-Q6HowdoIbindtoaspecificIPaddress?"><span class="confluence-anchor-link" id="Connectors-Q6"></span>How do I bind to a specific IP address?</h3><p>Each Connector element allows an <code>address</code> property. See the <a class="external-link" href="https://tomcat.apache.org/tomcat-7.0-doc/config/http.html" rel="nofollow">HTTP Connector docs</a> or the <a class="external-link" href="https://tomcat.apache.org/tomcat-7.0-doc/config/ajp.html" rel="nofollow">AJP Connector docs</a>.</p><h3 id="Connectors-Q7WherecanIdownloadabinarydistributionofmyconnector?"><span class="confluence-anchor-link" id="Connectors-Q7"></span>Where can I download a binary distribution of my connector?</h3><p>You cannot: you need to download the source and compile it for your platform. The source distributions are available from the <a class="external-link" href="https://tomcat.apache.org/download-connectors.cgi" rel="nofollow">standard location</a>. Note that JPackage.org has RPM distributions for the connectors as well as tomcat itself: <a class="external-link" href="http://www.jpackage.org/" rel="nofollow">JPackage.org</a></p><h3 id="Connectors-Q8I&#39;mhavingstrangeUTF-8issueswithmyrequestparameters."><span class="confluence-anchor-link" id="Connectors-Q8"></span>I'm having strange UTF-8 issues with my request parameters.</h3><p>See <a href="Character-Encoding_103098774.html">Character Encoding</a></p><h3 id="Connectors-Q9HowdoIconfigureApacheTomcatconnectorsforaheavyloadsite?"><span class="confluence-anchor-link" id="Connectors-Q9"></span>How do I configure Apache Tomcat connectors for a heavy load site?</h3><p>See <a href="Performance-and-Monitoring_103099040.html">Performance and Monitoring</a></p><p><br/></p>
                    </div>

                                        
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on мая 02, 2023 11:01</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
