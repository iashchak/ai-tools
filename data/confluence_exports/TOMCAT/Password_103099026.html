<!DOCTYPE html>
<html>
    <head>
        <title>Apache Tomcat : Password</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Apache Tomcat</a></span>
                            </li>
                                                    <li>
                                <span><a href="Apache-Tomcat-Home_61320756.html">Apache Tomcat Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="FAQ_103098750.html">FAQ</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Apache Tomcat : Password
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> ASF Infrabot</span>, last modified by <span class='editor'> Remy Maucherat</span> on апр 10, 2019
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h2 id="Password-Whyareplaintextpasswordsintheconfigfiles?">Why are plain text passwords in the config files?</h2><p>Because there is no good way to &quot;secure&quot; them. When Tomcat needs to connect to a database, it needs the original password. While the password could be encoded, there still needs to be a mechanism to decode it. And since the source to Tomcat is freely available, the attacker would know the decoding method. So at best, the password is obscured - but not really protected. Please see the user and dev list archives for flame wars about this topic.</p><p>That said, any configuration file that does contain a password needs to be appropriately secured. That means <strong>limiting access</strong> to the file so that it could be read only by the user that Tomcat process runs as and root (or the administrator on Windows).</p><p>In <a class="external-link" href="http://www.catb.org/~esr/writings/cathedral-bazaar/" rel="nofollow">The Cathedral and the Bazaar</a>, Eric S. Raymond recounts a story where his fetchmail users asked for encrypted passwords in the .fetchmailrc file (which is almost identical to the situation posed here with server.xml). He refused <a class="external-link" href="http://www.catb.org/~esr/writings/cathedral-bazaar/cathedral-bazaar/ar01s09.html" rel="nofollow">using the same arguments posed here</a>: encrypting or otherwise obfuscating the password in server.xml does not provide any real security: only &quot;security by obscurity&quot; which isn't actually secure.</p><p>Auditors do not like this answer. In order to please auditors, feel free to do any of the following. Please be aware, that all of the following are &quot;security by obscurity&quot; and are not making the Tomcat more secure. But it may allow you to pass an auditors checklist ....</p><ul><li>Use properties replacement so that in the xml config you have ${db.password} and in conf/catalina.properties you put the password there.</li><li>Since server.xml is an XML file — you can use XML entities. For example: &quot;woot&quot; becomes &quot;&amp;#119;&amp;#111;&amp;#111;&amp;#116;&quot; which is a way to obscure the password. You may even go through an extra layer of indirection by converting ${db.password} into XML entities so that the property replacement above is also performed. (But remember, while &quot;clever, not more secure)</li><li>XML entities can be read from an external file. That is, add the following text at the top of server.xml just after the XML declaration (<code>&lt;?xml ...?&gt;</code>) and before the <code>&lt;Server&gt;</code> element (line wraps can be removed): <br/><pre>&lt;!DOCTYPE Server [
  &lt;!ENTITY resources SYSTEM &quot;resources.txt&quot;&gt;
]&gt;</pre></li></ul><ul><li>Now, whenever you write <code>&amp;resources;</code> in the text below, it will be replaced by the content of the file &quot;resources.txt&quot;. The file path is relative to the conf directory.</li><li>Write your own datasource implementation which wraps your datasource and obscure your brains out (<a class="external-link" href="http://en.wikipedia.org/wiki/XOR_cipher" rel="nofollow">XOR</a> and <a class="external-link" href="http://en.wikipedia.org/wiki/ROT13" rel="nofollow">ROT13</a> are great candidates for this since their strength matches the protection you'll actually get). See the docs on how to do this.</li><li>Write your own <code>javax.naming.spi.ObjectFactory</code> implementation that creates and configures your datasource.</li><li>Write your own <code>org.apache.tomcat.util.IntrospectionUtils.PropertySource</code> implementation to 'decrypt' passwords that are 'encrypted' in catalina.properties and referenced via ${...} in server.xml. You will need to set the <a class="external-link" href="https://tomcat.apache.org/tomcat-8.5-doc/config/systemprops.html" rel="nofollow">system property</a> <code>org.apache.tomcat.util.digester.PROPERTY_SOURCE</code> to point to your PropertySource implementation.<ul><li>An example of a project that provides such custom PropertySource: <a class="external-link" href="https://github.com/web-servers/tomcat-vault" rel="nofollow">Vault for Apache Tomcat</a>.</li></ul></li></ul><p>A cultural reference:</p><ul><li><a class="external-link" href="http://en.wikipedia.org/wiki/Turtles_all_the_way_down" rel="nofollow">It is turtles all the way down</a> (Wikipedia)</li></ul><p><br/></p><p><br/></p>
                    </div>

                                        
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on мая 02, 2023 11:01</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
