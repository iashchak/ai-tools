<!DOCTYPE html>
<html>
    <head>
        <title>Apache Tomcat : Community Review of DISA STIG</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Apache Tomcat</a></span>
                            </li>
                                                    <li>
                                <span><a href="Apache-Tomcat-Home_61320756.html">Apache Tomcat Home</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Apache Tomcat : Community Review of DISA STIG
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Christopher Schultz</span>, last modified by <span class='editor'> Mark Thomas</span> on мар 03, 2022
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h2 id="CommunityReviewofDISASTIG-Introduction">Introduction</h2><p>This is a community review of the (USA) Defense Information Systems Agency (DISA) Security Technical Implementation Guide (STIG) dated 2021-12-27 which can be browsed conveniently at this address:</p><p><a class="external-link" href="https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/" rel="nofollow">https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/</a></p><p>Similar documents have been drafted in the past and various members of this community including project maintainers, users, and administrators have expressed frustration regarding many of the items both included and not included in these guides. This document is intended to be a community-sourced review of the latest (at the time of this writing) version of the STIG, including specific recommendations from this community's members for improvements and modifications to the STIG.</p><p><strong>Recommendations and suggestions are welcome from any member of the community.</strong> We ask that if your recommended change is discussed and the group consensus is that no change should be recommended, please remove that suggestion from this document and do not bring it back up for discussion without some substantive change to the suggestion or the background/context of that suggestion. We ask this to avoid arguments raging in the history of this document. Feel free to have conversations on the various Tomcat-related mailing lists and post the results of those conversations into this document instead of using the document as a vehicle for communication.</p><p>This is a living document and changes can be made at any point, including changes that do not reflect any particular consensus of the Apache Tomcat Project Management Committee (PMC), the Apache Tomcat Security Team, etc. Any official recommendation made to DISA will be made for a <em>specific version</em> of this document which has supported consensus from one of more of the aforementioned groups.</p><h2 id="CommunityReviewofDISASTIG-Instructions">Instructions</h2><p>For anyone contributing to this review, please read the instructions below and participate in a constructive way. In order to coordinate our recommendations, it will be helpful if everyone follows a few simple rules:</p><ol><li>To recommend an improvement or modification to the STIG, please file your commentary under a sub-section of this document whose name is the same as the <em>Finding ID</em>, which is how STIGs are generally organized. Please keep these Finding IDs in alphanumeric order for easy identification.</li><li>In a single short sentence, describe the overall change that is being recommended. For example &quot;This finding is invalid,&quot; or &quot;The instructions for identifying this finding are incomplete,&quot; etc.</li><li>Provide appropriate background and context if appropriate. Remember that extraordinary claims require extraordinary evidence.</li><li>Provide a specific recommendation or recommendations at the end of the section for the finding.</li></ol><p><br/></p><h2 id="CommunityReviewofDISASTIG-Recommendations">Recommendations</h2><h3 id="CommunityReviewofDISASTIG-GeneralRecommendations">General Recommendations</h3><p>No general recommendations at this point.</p><h3 id="CommunityReviewofDISASTIG-Modifications">Modifications</h3><h4 id="CommunityReviewofDISASTIG-V-222931"><a class="external-link" href="https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/finding/V-222931" rel="nofollow">V-222931</a></h4><p>This finding contains multiple inaccuracies.</p><p>This finding claims that Apache Tomcat &quot;currently operates only on JKS, PKCS11, or PKCS12 format keystores.&quot; Further, it claims that the finding only applies to JKS keystores. Finally, it claims that Tomcat will use a default password of &quot;changeit&quot; if the keystore was not created with a password.</p><p>Many of the above are factually incorrect. Apache Tomcat can use JKS and PKCS12 format keystores, but PKCS11 is another thing entirely which can be accessed in various ways. Apache Tomcat also supports the use of JCEKS keystores and PEM-encoded DER files which can include password-protected content similar to the other keystores.</p><p>In all of these cases, Apache Tomcat will use any password provided by the administrator in the appropriate position in the configuration file. Apache Tomcat will indeed use &quot;changeit&quot; as the default password <em>if none is specified in the configuration</em> to load the keys from a keystore. Apache Tomcat does not create keystores, and any administrator would have to explicitly specify &quot;changeit&quot; as the password used to protect a given keystore.</p><p>The recommendations should be made to protect the keystore with a password (and explicitly <em>not</em> to use &quot;changeit&quot; which is the commonly-used password in all Java-keystore-related HOWTOs and other guides) and has nothing to do really with Apache Tomcat's behavior at all. Furthermore, <em>all</em> keys should be recommended to be protected, not just those in JKS and PKCS12 key stores. JCEKS and PEM-encoded-DER files should be given the same prescription.</p><h4 id="CommunityReviewofDISASTIG-V-222938"><a class="external-link" href="https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/finding/V-222938" rel="nofollow">V-222938</a></h4><p>The finding ignores valid settings that meet the requirement and the fix text is inaccurate.</p><p>Access logging may be configured per Engine, Host or Context. It is sufficient to configure one access log per Engine. It is also possible to meet the requirement to log all requests with various combinations of access logs at different levels. </p><p>The fix text states every element needs an access log valve. This is incorrect. The fix text - for the current meaning - should be every Host element needs an access log valve. However, note from the previous paragraph that other approaches are also possible.</p><p>A better way of phrasing this could be: For every possible combination of Engine, Host and Context that a request may be mapped to, at least one Container (Engine, Host and Context are all containers) must have a nested access log valve. The recommended approach is one per Host.</p><h4 id="CommunityReviewofDISASTIG-V-222939,V222942"><a class="external-link" href="https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/finding/V-222939" rel="nofollow">V-222939</a>, <a class="external-link" href="https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/finding/V-222942" rel="nofollow">V222942</a></h4><p>The findings ignore valid settings that meet the requirement.</p><p>The findings require that specific values are included in the pattern for the AccessLogValve but does not take into account that the values &quot;common&quot; and &quot;combined&quot; also include the required values.</p><p>The findings need to be edited to accept &quot;common&quot; or &quot;combined&quot;. The pattern example included in the finding is the &quot;common&quot; pattern.</p><h4 id="CommunityReviewofDISASTIG-V-222950"><a class="external-link" href="https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/finding/V-222950" rel="nofollow">V-222950</a></h4><p>This finding confuses HTTP TRACE and software application stack traces and recommends a course of action that does not provide any security benefit.</p><p>This finding claims that &quot;stack tracing provides debugging information ... that could be used to compromise the system.&quot; The recommended mitigation is to set the allowTrace attribute of all &lt;Connector&gt; elements to &quot;false&quot;. The claim is that by setting this attribute, application stack traces will be suppressed.</p><p>The claim is incorrect. While revealing stack traces may be helpful to a potential attacker, setting allowTrace=&quot;false&quot; does not disable application stack traces. Instead, it disables the HTTP TRACE verb which provides little to no security benefit. Application stack traces, if they had been possible to generate by an attacker before the configuration change, are still entirely possible for an attacker to cause.</p><p>We recommend that V-222950 be completely removed from the STIG as it has no perceivable benefit.</p><h4 id="CommunityReviewofDISASTIG-V-222964"><a class="external-link" href="https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/finding/V-222964" rel="nofollow">V-222964</a></h4><p>This finding misses multiple TLS settings for remote JMX.</p><p>The finding should also cover:</p><ul><li>com.sun.management.jmxremote.registry.ssl</li><li>com.sun.management.jmxremote.ssl.enabled.protocols</li><li>com.sun.management.jmxremote.ssl.enabled.cipher.suites</li></ul><h4 id="CommunityReviewofDISASTIG-V-222968"><a class="external-link" href="https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/finding/V-222968" rel="nofollow" style="font-weight: 600;letter-spacing: -0.003em;">V-222968</a></h4><p>This finding requires that FIPS-validated cipher (suites) are used on secure connectors, but gets confused after that.</p><p>It's not clear whether this Finding requires that a FIPS-validated cryptographic module be used in FIPS mode, or that a FIPS-validated cryptographic module must be used (in any mode), or that only cipher suites be FIPS-140-2 validated (whatever that means). It also states that setting FIPSMode=&quot;on&quot; on the AprLifecycleListener (a) will enable FIPS and (b) FIPS mode is not possible without it.</p><p>Enabling the AprLifecycleListener and using FIPSMode=&quot;on&quot; is only applicable if OpenSSL is being used as the underlying cryptographic module, and that module has been built with FIPS support. There are other ways to use FIPS-valiated cryptographic modules that do not use this setting.</p><p>This recommendation should clarify what is actually required, and be specific about how to ensure that a FIPS-validated module is actually in use.</p><h4 id="CommunityReviewofDISASTIG-V-222981"><a class="external-link" href="https://www.stigviewer.com/stig/apache_tomcat_application_sever_9/2021-12-27/finding/V-222981" rel="nofollow">V-222981</a></h4><p>The title of this finding describes a requirement that cannot be met.</p><p>The LockOutRealm does not distinguish between admin and non-admin users. The lock out rules apply equally to all users.</p><p>The title should be edited to remove the text &quot;...for admin users&quot;.</p><h3 id="CommunityReviewofDISASTIG-Additions">Additions</h3><h4 id="CommunityReviewofDISASTIG-RemoteJMX">Remote JMX</h4><p>The findings cover a number of settings regarding the use of remote JMX but does not cover all risks.</p><p>The default remote JMX authentication mechanism does not implement any access logging so it is not possible to audit use, or attempted use, of the interface.</p><p>The default remote JMX authentication mechanism does not implement any form of account lock-out and is therefore vulnerable to brute-force attacks.</p><p>Remote JMX has a very crude access control model. Access is either &quot;read everything&quot; or &quot;read/write everything&quot;. Even read access provides access to potentially sensitive data. Any access via remote JMX should be considered equivalent to &quot;super user&quot; access. There is no way to mitigate this risk short of disabling remote JMX entirely.  There is a strong case to be made for accessing JMX via some form of (local to Tomcat) proxy that addresses this risk.  It is likely such a proxy woudl address other risks as well.</p><p><br/></p><p><br/></p><p><br/></p>
                    </div>

                                        
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on мая 02, 2023 11:02</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
