<!DOCTYPE html>
<html>
    <head>
        <title>Apache Tomcat : Security</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Apache Tomcat</a></span>
                            </li>
                                                    <li>
                                <span><a href="Apache-Tomcat-Home_61320756.html">Apache Tomcat Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="FAQ_103098750.html">FAQ</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Apache Tomcat : Security
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> ASF Infrabot</span>, last modified by <span class='editor'> Timothy A. Funk</span> on июн 13, 2022
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><em>Permalink</em> to this page: <a href="https://cwiki.apache.org/confluence/x/qyolBg" rel="nofollow">https://cwiki.apache.org/confluence/x/qyolBg</a></p><h2 id="Security-Preface">Preface</h2><p>This FAQ section provides help with some security-related issues. If you hear of a vulnerability or its exploitation, please see the <a class="external-link" href="https://tomcat.apache.org/security.html" rel="nofollow">security page</a>.</p><h3 id="Security-TheRecord">The Record</h3><p>There have been no public cases of damage done to a company, organization, or individual due to a Tomcat security issue. There have been no documented cases of data loss or application crashes caused by an intruder. While there have been numerous analyses conducted on Tomcat, partially because this is easy to do with Tomcat's source code openly available, there have been only <strong>theoretical</strong> vulnerabilities found. All of those were addressed even though there were no documented cases of actual exploitation of these vulnerabilities.</p><p>That said,</p><ul><li>There have been several reports of a compromise done via guess of the password of a user of the Manager web application.</li></ul><p style="margin-left: 30.0px;">There was once a bug that blindly clicking-trough the Windows installer configured a manager user with blank password (<a class="external-link" href="https://tomcat.apache.org/security-6.html#Fixed_in_Apache_Tomcat_6.0.24" rel="nofollow">CVE-2009-3548</a>). This was fixed by April 2010 (Tomcat 5.5.29, 6.0.24 and later are safe).</p><p style="margin-left: 30.0px;">Please see &quot;Security considerations&quot; pages in Tomcat documentation (<a href="#Security-Links">linked below</a>) for a reference on how access to Management Applications in Tomcat should be secured.</p><ul><li>There have been several reports of compromises via vulnerabilities in 3-rd party web applications deployed on Tomcat. E.g. vulnerabilities in Apache Struts framework were a popular attack target several times in years 2013-2017. E.g. <a class="external-link" href="https://blogs.apache.org/foundation/entry/apache-struts-statement-on-equifax" rel="nofollow">Equifax breach</a> in year 2017. It is unknown whether Equifax has run their application on Tomcat, but there have been a number of similar compromise reports from Tomcat users. Those are not caused by a vulnerability in Tomcat.</li></ul><h3 id="Security-RoleofCustomization">Role of Customization</h3><p>We believe, and the evidence suggests, that Tomcat is more than secure enough for most use-cases. However, like all other components of Tomcat, you can customize any and all of the relevant parts of the server to achieve even higher security. For example, the session manager implementation is pluggable, and even the default implementation has support for pluggable random number generators. If you have a special need that you feel is not met by Tomcat out of the box, consider these customization options. At the same time, please bring up your requirements on the user mailing list, where we'll be glad to discuss it and assist in your approach/design/implementation as needed.</p><p>It is also possible to configure Tomcat insecurely. Please see &quot;Security considerations&quot; pages in Tomcat documentation (<a href="#Security-Links">linked below</a>) for the list of security-sensitive options.</p><h3 id="Security-Links">Links</h3><ul><li>Known vulnerabilities: <a class="external-link" href="https://tomcat.apache.org/security.html" rel="nofollow">https//tomcat.apache.org/security.html</a></li><li>Security considerations (Tomcat documentation) — <a class="external-link" href="https://tomcat.apache.org/tomcat-9.0-doc/security-howto.html" rel="nofollow">Tomcat 9</a>, <a class="external-link" href="https://tomcat.apache.org/tomcat-8.5-doc/security-howto.html" rel="nofollow">Tomcat 8.5</a>, <a class="external-link" href="https://tomcat.apache.org/tomcat-7.0-doc/security-howto.html" rel="nofollow">Tomcat 7</a>.</li></ul><h2 id="Security-Questions">Questions</h2><ol><li><a href="#Security-Q1">How do I use OpenSSL to set up my own Certificate Authority (CA)?</a></li><li><a href="#Security-Q2">Oh no! Port 8005 is available for anyone on localhost to shutdown my tomcat!</a></li><li><a href="#Security-Q3">What about Tomcat running as root?</a></li><li><a href="#Security-Q4">How do I force all my pages to run under HTTPS?</a></li><li><a href="#Security-Q5">What is the default login for the manager and admin app?</a></li><li><a href="#Security-Q6">How do I restrict access by ip address or remote host?</a></li><li><a href="#Security-Q7">How do I use jsvc/procrun to run Tomcat on port 80 securely?</a></li><li><a href="#Security-Q8">Has Tomcat's security been independently analyzed or audited?</a></li><li><a href="#Security-Q9">How do I change the Server header in the response?</a></li><li><a href="#Security-Q10">Why are passwords in plain text?</a></li><li><a href="#Security-Q11">How can I restrict the list of ciphers used for HTTPS?</a></li><li><a href="#Security-Q12">Which cipher suites should I use?</a></li><li><a href="#Security-Q13">Is Tomcat affect by Log4Shell CVE-2021-44228?</a></li><li><a href="#Security-Q14">I found a vulnerability in JMXProxy</a></li></ol><h2 id="Security-Answers">Answers</h2><h3 id="Security-Q1HowdoIuseOpenSSLtosetupmyownCertificateAuthority(CA)?"><span class="confluence-anchor-link" id="Security-Q1"></span>How do I use OpenSSL to set up my own Certificate Authority (CA)?</h3><p><a class="external-link" href="https://marc.info/?l=tomcat-user&amp;m=106293430225790&amp;w=2" rel="nofollow">Using OpenSSL to set up your own CA</a>.</p><h3 id="Security-Q2Ohno!Port8005isavailableforanyoneonlocalhosttoshutdownmytomcat!"><span class="confluence-anchor-link" id="Security-Q2"></span>Oh no! Port 8005 is available for anyone on localhost to shutdown my tomcat!</h3><p>See these 2 discussions.</p><ul><li><a class="external-link" href="https://marc.info/?t=104396653200003&amp;r=1&amp;w=2" rel="nofollow">Possible to switch off tcp/ip server shutdown?</a></li><li><a class="external-link" href="https://marc.info/?t=103126643200005&amp;r=1&amp;w=2" rel="nofollow">Tomcat shutdown &amp; security</a></li></ul><h3 id="Security-Q3WhataboutTomcatrunningasroot?"><span class="confluence-anchor-link" id="Security-Q3"></span>What about Tomcat running as root?</h3><p>See these threads:</p><ul><li><a class="external-link" href="https://marc.info/?t=104516038700003&amp;r=1&amp;w=2" rel="nofollow">Tomcat as root and security issues</a></li></ul><h3 id="Security-Q4HowdoIforceallmypagestorununderHTTPS?"><span class="confluence-anchor-link" id="Security-Q4"></span>How do I force all my pages to run under HTTPS?</h3><p><a class="external-link" href="https://marc.info/?l=tomcat-user&amp;m=104951559722619&amp;w=2" rel="nofollow">Use security-constraint in web.xml</a>.</p><h3 id="Security-Q5Whatisthedefaultloginforthemanagerandadminapp?"><span class="confluence-anchor-link" id="Security-Q5"></span>What is the default login for the manager and admin app?</h3><p>The admin and manager application do not provide a default login. Doing so would be a security flaw. You need to edit $CATALINA_HOME/conf/tomcat-users.xml file if you are using the default install. See <a class="external-link" href="https://tomcat.apache.org/tomcat-9.0-doc/manager-howto.html#Configuring_Manager_Application_Access" rel="nofollow">Configuring Manager Application Access</a> for details.</p><p>Note that there exists malware that tries to guess the manager password.</p><p>There was once a bug that blindly clicking-trough the Windows installer configured a manager user with blank password (<a class="external-link" href="https://tomcat.apache.org/security-6.html#Fixed_in_Apache_Tomcat_6.0.24" rel="nofollow">CVE-2009-3548</a>). This was fixed by April 2010 (Tomcat 5.5.29, 6.0.24 and later are safe).</p><h3 id="Security-Q6HowdoIrestrictaccessbyipaddressorremotehost?"><span class="confluence-anchor-link" id="Security-Q6"></span>How do I restrict access by ip address or remote host?</h3><p>By using the <code>RemoteHostValve</code> or <code>RemoteAddrValve</code>. Warning, these valves rely on accurate incoming ip addresses or hostnames. So they can fall victim to spoofing! See also <code>RemoteIpValve</code>. <a class="external-link" href="https://tomcat.apache.org/tomcat-9.0-doc/config/valve.html#Access_Control" rel="nofollow">Valve Reference Link</a></p><h3 id="Security-Q7HowdoIusejsvc/procruntorunTomcatonport80securely?"><span class="confluence-anchor-link" id="Security-Q7"></span>How do I use jsvc/procrun to run Tomcat on port 80 securely?</h3><p>Fairly easily <img class="emoticon emoticon-wink" src="images/icons/emoticons/wink.svg" data-emoticon-name="wink" alt="(подмигивание)"/> See the Setup page in the docs for your tomcat release, and read <a class="external-link" href="https://marc.info/?l=tomcat-user&amp;m=108566020231438&amp;w=2" rel="nofollow">this mailing list post</a> for a complete setup example with permissions etc.</p><h3 id="Security-Q8HasTomcat&#39;ssecuritybeenindependentlyanalyzedoraudited?"><span class="confluence-anchor-link" id="Security-Q8"></span>Has Tomcat's security been independently analyzed or audited?</h3><p>Yes, by numerous organizations and individuals, many times. Try <a class="external-link" href="https://www.google.com/search?q=is+tomcat+secure" rel="nofollow">this Google search</a> and you'll see many references, guides, and analyses.</p><h3 id="Security-Q9HowdoIchangetheServerheaderintheresponse?"><span class="confluence-anchor-link" id="Security-Q9"></span>How do I change the Server header in the response?</h3><p>In <code>server.xml</code> file add a &quot;server&quot; attribute to the Connector element. <a class="external-link" href="https://tomcat.apache.org/tomcat-9.0-doc/config/http.html" rel="nofollow">https://tomcat.apache.org/tomcat-9.0-doc/config/http.html</a></p><h3 id="Security-Q10Whyarepasswordsinplaintext?"><span class="confluence-anchor-link" id="Security-Q10"></span>Why are passwords in plain text?</h3><p>We have a page dedicated to this topic. <a href="Password_103099026.html">Password</a></p><h3 id="Security-Q11HowcanIrestrictthelistofciphersusedforHTTPS?"><span class="confluence-anchor-link" id="Security-Q11"></span>How can I restrict the list of ciphers used for HTTPS?</h3><p>See <a href="HowTo-SSLCiphers_103099295.html">HowTo SSLCiphers</a>.</p><h3 id="Security-Q12WhichciphersuitesshouldIuse?"><span class="confluence-anchor-link" id="Security-Q12"></span>Which cipher suites should I use?</h3><p>See <a href="Ciphers_118166026.html">Security/Ciphers</a>.</p><h3 id="Security-Q13IsTomcataffectbyLog4ShellCVE-2021-44228?"><span class="confluence-anchor-link" id="Security-Q13"></span>Is Tomcat affect by Log4Shell CVE-2021-44228?</h3><p>Out of the box  - No.</p><p>But that doesn't prevent an application deployed to Tomcat from using log4j2. In which case, please use general guidance on various remediations. As of this writing, they include any of these </p><ul><li>Upgrading log4j2 to 2.16.0 (or better)<ul><li>This is the best fix (2.15.0 was also insufficient due to CVE-2021-45046)</li></ul></li><li>Use system property log4j2.formatMsgNoLookups=true to disable message formatting<ul><li>This is a reasonable workaround - But due to CVE-2021-45046 you may still have other vulnerabilities</li><li>Setting a shell environment variable <code>LOG4J_FORMAT_MSG_NO_LOOKUPS=true</code> should work too</li></ul></li><li>Remove the following files from your jar file: log4j-core-2.XX.Y.jar  (This is a hack. A simple one but effective. This also remediates CVE-2021-45046)<ul><li><pre>org/apache/logging/log4j/core/net/JndiManager$1.class</pre></li><li><pre>org/apache/logging/log4j/core/util/JndiCloser.class</pre></li><li><pre>org/apache/logging/log4j/core/net/JndiManager$JndiManagerFactory.class</pre></li><li><pre>org/apache/logging/log4j/core/lookup/JndiLookup.class</pre></li><li><pre>org/apache/logging/log4j/core/net/JndiManager.class</pre></li><li><pre>org/apache/logging/log4j/core/selector/JndiContextSelector.class</pre></li></ul></li><li>Ensuring your JRE is 1.8.121 or better. (This version doesn't fix the issue, it just eliminates one very easy to exploit attack vector.)<ul><li>Not recommended but better than nothing. When combined with the limiting of creating socket connections, this will make payloads harder (but not impossible) to deploy.</li><li>But these 2 system properties must also be set to false (or unset) com.sun.jndi.rmi.object.trustURLCodebase,com.sun.jndi.cosnaming.object.trustURLCodebase</li><li>Newer JVM's can still fall victim to this attack with the older log4j2. It is beyond the scope of this FAQ to explain how. But the TL;DR is it the exploit becomes more application or application server specific.</li></ul></li></ul><p><a class="external-link" href="https://blogs.apache.org/foundation/entry/apache-log4j-cves" rel="nofollow">More details on these CVE's via the ASF blog</a></p><h3 id="Security-Q14IfoundavulnerabilityinJMXProxy"><span class="confluence-anchor-link" id="Security-Q14"></span>I found a vulnerability in JMXProxy</h3><p>JMXProxy is a powerful servlet which has full access to all JMX capabilities. <strong>By design</strong>, enabling it opens you to a lot of security challenges. The equivalent of enabling generic remote JMX access at the JVM level.</p><p><br/></p><p>With that in mind, if you enable it: You should <strong>at a minimum</strong> require an extremely strong password to protect this URL as well restrict the IP client list which may access it. (Ideally restricting it to localhost if possible)</p><p><br/></p><p><br/></p>
                    </div>

                                        
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on мая 02, 2023 11:01</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
