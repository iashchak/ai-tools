<!DOCTYPE html>
<html>
    <head>
        <title>TIKA : Release Process</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">TIKA</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home_109454051.html">Home</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            TIKA : Release Process
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> ASF Infrabot</span>, last modified by <span class='editor'> Tim Allison</span> on окт 03, 2022
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="ReleaseProcess-Tikareleaseprocess">Tika release process</h1><h2 id="ReleaseProcess-Beforetherelease">Before the release</h2><p>Run <code>mvn ossindex:audit -Dossindex.fail=true</code><span style="color: rgb(51,51,153);"><code> </code></span>to see if there are any vulnerable dependencies.</p><p>Run <span style="color: rgb(51,51,153);"><code>mvn versions:display-plugin-updates</code></span> and <span style="color: rgb(51,51,153);">mvn versions:display-dependency-updates</span> to identify any updates that need to be made.</p><p>Make sure to run full regression tests after making updates with <code><span style="color: rgb(51,51,153);">mvn -Prelease-profile clean verify</span></code>.</p><h2 id="ReleaseProcess-Makingarelease">Making a release</h2><p>If you've done this before, have all programs installed, all necessary karma granted, and everything configured, steps 1 though 9 will take around an hour (tests take a while to run). If you've never done this before, you will probably run into an issue not covered in this set of instructions. So, it will take longer (maybe a couple hours, maybe a couple days).</p><p>Either way, please update these instructions with any clarifications you think might help the next release manager.</p><ol><li><code><span style="color: rgb(51,51,153);">git clone <a class="external-link" href="https://github.com/apache/tika.git" rel="nofollow" style="color: rgb(51,51,153);">https://github.com/apache/tika.git</a> release OR git clone https://github.com/apache/tika.git -b branch_1x</span></code></li><li><p class="auto-cursor-target">Add to the &lt;scm&gt; section in tika-parent's pom</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>    &lt;connection&gt;scm:git:https://github.com/apache/&lt;/connection&gt;
    &lt;developerConnection&gt;scm:git:https://github.com/apache/&lt;/developerConnection&gt;
    &lt;url&gt;https://github.com/apache/tika&lt;/url&gt;</pre>
</div></div><p class="auto-cursor-target">Background: for some reason in the 2.x branch these lines are deleted during each release process.  They are not deleted in the 1.x branch.</p></li><li>Update CHANGES.txt with release date (Release X.Y.Z - MM/dd/yyyy (date format matters!) and (if needed) add additional changelog entries.</li><li>On the Tika JIRA, create versions X.Y.Z, X.(Y+1), and X.(Y+2), if not already done.<ol><li>Move any lingering unresolved issues from X.Y.Z to X.(Y+1).<ol><li>Query open issues: e.g. &quot;project = Tika AND resolution = unresolved AND fixVersion = 1.16&quot;</li><li>Upper right, select bulk change</li><li>Select all, modify to fixVersion = X.(Y+1)</li><li>At the bottom of the screen, unselect the email updates</li></ol></li></ol></li><li><span style="color: rgb(51,51,153);"><code>git add CHANGES.txt &amp;&amp; git commit -m &quot;Update CHANGES.txt for X.Y.Z release.&quot; &amp;&amp; git push origin</code></span></li><li>Run <code><span style="color: rgb(51,51,153);">mvn apache-rat:check</span></code> and fix any missing license headers / add excluded for properly non-licensed fails</li><li><span style="color: rgb(51,51,153);"><code>setenv MAVEN_OPTS &quot;-Xms128m -Xmx256m&quot;</code></span> (or <span style="color: rgb(51,51,153);">export MAVEN_OPTS=&quot;-Xms128m -Xmx256m&quot;</span> if you are using bash)</li><li><span style="color: rgb(51,51,153);"><code>mvn release:prepare</code></span><br/><ol><li>Make sure all the release numbers are set to X.Y.Z (from X.Y.Z-SNAPSHOT)</li><li>When prompted, the scm tag name should be X.Y.Z (version number). If this is a release candidate, the tag should be X.Y.Z-rcN.</li><li>Watch for a <code>BUILD SUCCESSFUL</code> message</li><li>Make sure you have <code>gnupg</code> (or variant) installed (see <a class="external-link" href="https://www.apache.org/dev/openpgp.html" rel="nofollow">https://www.apache.org/dev/openpgp.html</a>)</li></ol></li><li><code>mvn release:perform</code><ol><li>Make sure you can log on to <a class="external-link" href="https://repository.apache.org/" rel="nofollow">https://repository.apache.org/</a></li><li>Make sure you have the following entry in your <span style="color: rgb(51,51,153);">~/.m2/settings.xml</span> file: <a class="external-link" href="https://maven.apache.org/settings.html#Servers" rel="nofollow">https://maven.apache.org/settings.html#Servers</a>. The server ID should be <code><span style="color: rgb(51,51,153);">apache.releases.https</span></code>.</li></ol></li><li>Head over to <a class="external-link" href="https://repository.apache.org/" rel="nofollow">https://repository.apache.org/</a> (Apache's Nexus Server)<ol><li>Login with your ASF username and password</li><li>Make sure there is only one repo from your build and that it contains everything. A transmission failure can lead to multiple repositories, none of which are valid... even when <code><span style="color: rgb(51,51,153);">mvn release:perform</span></code> alleges <code>SUCCESS</code></li><li>&quot;Close&quot; the staging repository with message <code>Apache Tika X.Y.Z release candidate #N</code>.</li><li>Copy the URL from the closed staged repository for Tika (you'll need this later)</li></ol></li><li>Update CHANGES.txt with a &quot;Release X.Y.Z + 1 - Current Development&quot; section.</li><li>Check the contents of <span style="color: rgb(51,51,153);"><code>target/checkout/target/X.Y.Z/*</code></span> into <a class="external-link" href="https://dist.apache.org/repos/dist/dev/tika/" rel="nofollow">https://dist.apache.org/repos/dist/dev/tika/</a> (<code>tika-X.Y.Z-src.zip{.asc|.sha512}</code>, <code>tika-app-X.Y.Z.jar{.asc|.sha512}</code> and <code>tika-server-X.Y.Z.jar{.asc|.sha512}</code>, and <code>CHANGES.txt</code>.<ol><li><code><span style="color: rgb(51,51,153);">svn co https://dist.apache.org/repos/dist/dev/tika/ dist.dev.tika</span></code></li><li><code><span style="color: rgb(51,51,153);">cd dist.dev.tika</span></code></li><li><code>mkdir X.Y.Z</code></li><li><code>rm -r X.Y.Z-1 </code>(remove the former dist dev version folder)</li><li><code>cp ../release/target/checkout/target/X.Y.Z/* X.Y.Z</code> (copy the artifacts into the new dist.dev.tika/X.Y.Z directory)</li><li><code>cd X.Y.Z</code></li><li><span style="color: rgb(51,51,153);"><code>mv CHANGES.txt CHANGES-X.Y.Z.txt</code></span></li><li>make sure the KEYS files is at <code>dist.dev.tika/KEYS</code> -- if it isn't there already copy the <span style="color: rgb(51,51,153);"><code>KEYS</code></span> file to go along with the jars and other release artifacts; add your key to <span style="color: rgb(51,51,153);"><code>KEYS</code></span> if you haven't already</li><li><span style="color: rgb(51,51,153);"><code>svn add X.Y.Z</code></span></li><li><span style="color: rgb(51,51,153);"><code>svn commit -m &quot;Add Tika X.Y.Z RC#N artifacts.&quot;</code></span></li><li>See the file in <span style="color: rgb(51,51,153);"><code>target/checkout/target/vote.txt</code></span> - it contains the contents of the release email you should send (with subject <span style="color: rgb(51,51,153);"><code>[VOTE] Apache Tika X.Y.Z Release Candidate N</code></span> to <a class="external-link" href="mailto:dev@tika.apache.org" rel="nofollow">dev@tika.apache.org</a> and to <a class="external-link" href="mailto:user@tika.apache.org" rel="nofollow">user@tika.apache.org</a>). Ensure all URLs are correct and update the email to include links to the artifacts from #8 (including .sha512, .asc and CHANGES.txt)</li></ol></li><li>If the VOTE passes:<br/><ol><li><p>Send <span style="color: rgb(51,51,153);"><code>[RESULT] [VOTE]</code></span> tallying the VOTE to <a class="external-link" href="mailto:dev@tika.apache.org" rel="nofollow">dev@tika.apache.org</a> and <a class="external-link" href="mailto:user@tika.apache.org" rel="nofollow">user@tika.apache.org</a></p></li><li>Head over to Nexus from #6 and &quot;Release&quot; the repository with message Apache Tika X.Y.Z release (and make sure the box is checked to auto drop).</li><li><span style="color: rgb(51,51,153);"><code>svn rm <span class="nolink">https://dist.apache.org/repos/dist/release/tika/X.Y.Z-1* </span></code></span>(delete the previous release)</li><li><span style="color: rgb(51,51,153);"><code>svn mv <span class="nolink">https://dist.apache.org/repos/dist/dev/tika/X.Y.Z/*</span> https://dist.apache.org/repos/dist/release/tika/X.Y.Z/*</code></span></li><li><span style="color: rgb(51,51,153);"><code>git clone <span class="nolink">https://github.com/apache/tika.git</span> X.Y.Z-rcN</code></span></li><li>Add final tag for the release and delete the X.Y.Z-rcN tag:<ol><li>Look up commit for X.Y.Z-rcN commit: <span style="color: rgb(51,51,153);"><code>git rev-list \-n 1 1.25-rc2</code></span>; let's say '0090ebac8e4ff4083a9c0c5d3dc55f545ad6f951'</li><li><span style="color: rgb(51,51,153);"><code>git tag -a X.Y.Z 0090eba -m &quot;Tagging X.Y.Z release&quot;</code></span></li><li><code><span style="color: rgb(51,51,153);">git tag -d X.Y.Z-rcN</span></code></li><li><code><span style="color: rgb(51,51,153);">git push --tags</span></code></li><li><code><span style="color: rgb(51,51,153);">git push origin :refs/tags/X.Y.Z-rcN</span></code></li></ol></li></ol></li><li>If VOTE fails:<ol><li>Drop the new Tika staging repository on <a class="external-link" href="https://repository.apache.org" rel="nofollow">https://repository.apache.org</a></li><li>Make an entry in CHANGES.txt which documents the subsequent changes between release candidates. This is extremely useful if the candidates are cut from master and master has moved on since the release candidate was originally cut.</li><li>Go back to #1.</li></ol></li><li>Update the version of any unreleased modules (like tika-dotnet).</li><li>Update Tika site.<ol><li>Update parent version number in the site pom.xml file.</li><li>Update the Documentation section of src/site/site.xml. Make sure to add the <code>collapse</code> tag for the now old version.</li><li>Update the &quot;Full List of Supported Formats&quot; section of the formats page of version X.Y.Z using TIKA-411; e.g. <code>java -jar release-X.Y.Z/tika-app/target/tika-app-1.15.jar --list-parser-details-apt &gt;&gt; src/site/apt/1.15/formats.apt</code></li><li>Update the version towards the top of X.Y.Z/formats.apt: <code>src/site/apt/1.15/formats.apt</code></li><li>Update the version number in the dependency examples and the commandline options in the new X.Y.Z src/site/apt/X.Y.Z/gettingstarted.apt page.</li><li>Update src/site/resources/doap.rdf with the new release.</li><li>Create a new example and formats page (truncated to where step 15.3 should go next time) for the next version (but don't list it in the sidebar).</li><li>Update src/site/apt/index.apt.vm to include the announcement and change link to previous release CHANGES.txt file (from <span><span style="color: rgb(0,0,0);"><span style="color: rgb(51,51,153);"><code>https://dist.apache.org/repos/dist/release/tika/X.Y.Z/CHANGES-X.(Y-1).txt</code></span> to <code><span style="color: rgb(51,51,153);">https://archive.apache.org/dist/tika/X.(Y-1)/CHANGES-X.(Y-1).txt</span></code>)</span></span>.</li><li>Update src/site/apt/X.Y.Z/index.apt.<ol><li>Generate the contributor list with <a class="external-link" href="https://github.com/chrismattmann/apachestuff/blob/master/extract-tika-contribs" rel="nofollow" style="letter-spacing: 0.0px;">https://github.com/chrismattmann/apachestuff/blob/master/extract-tika-contribs</a></li><li><span>Update the link to the JIRA query (e.g. </span><a class="external-link" href="https://s.apache.org/XowY" rel="nofollow">https://s.apache.org/XowY</a><span>) via Apache's shortening service </span><a class="external-link" href="https://s.apache.org" rel="nofollow">https://s.apache.org</a></li><li><span style="letter-spacing: 0.0px;">Generate the issues list by running </span><a class="external-link" href="https://github.com/chrismattmann/apachestuff/blob/master/extract-tika-issues.py" rel="nofollow" style="letter-spacing: 0.0px;">https://github.com/chrismattmann/apachestuff/blob/master/extract-tika-issues.py</a><span style="letter-spacing: 0.0px;"> CHANGES-X.Y.Z.txt output.txt X.Y.Z<br/></span></li></ol></li><li>Generate the Javadoc.<ol><li><span style="color: rgb(51,51,153);"><code style="letter-spacing: 0.0px;">unzip tika-X.Y.Z-src.zip <br/></code></span></li><li><span style="color: rgb(51,51,153);"><code style="letter-spacing: 0.0px;">mvn javadoc:aggregate</code></span></li><li><span style="color: rgb(51,51,153);"><code style="letter-spacing: 0.0px;">mkdir .../tika-site/publish/X.Y.Z</code></span></li><li><span style="color: rgb(51,51,153);"><code style="letter-spacing: 0.0px;">mv target/site/apidocs .../tika-site/publish/X.Y.Z/api</code></span></li></ol></li><li>Update tika-server documentation:<ol><li>In the unzipped src release, <code>cd tika-server</code></li><li><code>mvn -Pserver install </code>(in the tika-server module to build the miredot documentation)</li><li><span style="color: rgb(51,51,153);"><code style="letter-spacing: 0.0px;">mkdir .../tika-site/src/site/resources/X.Y.Z</code></span></li><li><code>rm -r tika-site/src/site/resources/X.Y.Z/miredot</code> (if it exists?!)</li><li><span style="color: rgb(51,51,153);"><code style="letter-spacing: 0.0px;">cp -r tika-server/target/miredot .../tika/site/src/site/resources/X.Y.Z</code></span></li></ol></li><li>Update the downloads section.</li><li>Check everything looks good with <code>mvn site:run</code>.</li><li><span style="color: rgb(51,51,153);"><code style="letter-spacing: 0.0px;">mvn clean install</code></span></li><li><code><span style="color: rgb(51,51,153);">svn add &lt;any files changed for site&gt;</span></code> (probably: <code><span style="color: rgb(51,51,153);">src/site/apt/X.Y.Z</span></code> and <code><span style="color: rgb(51,51,153);">src/site/resources/X.Y.Z/miredot</span></code>) &amp;&amp; <code><span style="color: rgb(51,51,153);">svn commit -m &quot;Update website for X.Y.Z release.&quot;</span></code></li><li><code style="letter-spacing: 0.0px;">On the Tika JIRA, &quot;release&quot; version X.Y.Z and update any (new) straggler X.Y.Z issues to X.(Y+1).</code></li></ol></li><li>Send announcements to <a class="external-link" href="mailto:user@tika.apache.org" rel="nofollow">user@tika.apache.org</a>, <a class="external-link" href="mailto:dev@tika.apache.org" rel="nofollow">dev@tika.apache.org</a>, and <a class="external-link" href="mailto:announce@apache.org" rel="nofollow">announce@apache.org</a> lists (from your Apache email) - see <a class="external-link" href="https://s.apache.org/ytaod" rel="nofollow">https://s.apache.org/ytaod</a> for a sample. If editing and resending an earlier email, make sure that you use text format and/or make sure that editing the links updates the underlying links and not just the anchor text.</li><li>Log on to <a class="external-link" href="https://reporter.apache.org/addrelease.html?tika" rel="nofollow">https://reporter.apache.org/addrelease.html?tika</a> and add the release data (version and date) to the database</li></ol><p><strong>NOTE:</strong> if anything goes wrong during <code>mvn:release-prepare</code> or <code>mvn release:perform</code>:</p><ol><li><span style="color: rgb(51,51,153);"><code>mvn release:clean</code></span></li><li>Undo any commits that changed the version number</li><li>Delete the X.Y.Z-rcN tag: <span style="color: rgb(51,51,153);"><code>gi</code><code>t</code><code> push --delete origin X.Y.Z-rcN &amp;&amp; git tag --delete X.Y.Z-rcN</code></span></li></ol><p>After the release, consider making a PR to make the upgrade in Apache Solr. See <a href="UpgradingTikaInSolr_109454102.html">UpgradingTikaInSolr</a>.</p><p>After the release, announce any CVEs that were fixed and update <code><span style="color: rgb(51,51,153);">security.apt</span></code> and republish the site.</p><h2 id="ReleaseProcess-Aftertheprojectrelease">After the project release</h2><h3 id="ReleaseProcess-ReleasetheDockerImage">Release the Docker Image</h3><p><a href="Release-Process-for-tika-docker_177051223.html">Release Process for tika-docker</a></p><h3 id="ReleaseProcess-ReleasetheHelmChart">Release the Helm Chart</h3><p><a class="external-link" href="https://wiki.apache.org/confluence/display/TIKA/Release+Process+for+tika-helm" rel="nofollow">Release Process for tika-helm</a></p><p><br/></p>
                    </div>

                                        
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on мая 02, 2023 15:13</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
